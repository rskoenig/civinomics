function printSingleValue(e){var t=""+e;if(e instanceof Date)t=dc.dateFormat(e);else if(typeof e=="string")t=e;else if(typeof e=="number")t=Math.round(e);return t}function isNegligible(e){return e===undefined||e<dc.constants.NEGLIGIBLE_NUMBER&&e>-dc.constants.NEGLIGIBLE_NUMBER}dc={version:"1.3.0",constants:{CHART_CLASS:"dc-chart",DEBUG_GROUP_CLASS:"debug",STACK_CLASS:"stack",DESELECTED_CLASS:"deselected",SELECTED_CLASS:"selected",NODE_INDEX_NAME:"__index__",GROUP_INDEX_NAME:"__group_index__",DEFAULT_CHART_GROUP:"__default_chart_group__",EVENT_DELAY:40,NEGLIGIBLE_NUMBER:1e-10},_renderlet:null};dc.chartRegistry=function(){function t(t){if(!t)t=dc.constants.DEFAULT_CHART_GROUP;if(!e[t])e[t]=[];return t}var e={};this.has=function(t){for(var n in e){if(e[n].indexOf(t)>=0)return true}return false};this.register=function(n,r){r=t(r);e[r].push(n)};this.clear=function(){e={}};this.list=function(n){n=t(n);return e[n]};return this}();dc.registerChart=function(e,t){dc.chartRegistry.register(e,t)};dc.hasChart=function(e){return dc.chartRegistry.has(e)};dc.deregisterAllCharts=function(){dc.chartRegistry.clear()};dc.filterAll=function(e){var t=dc.chartRegistry.list(e);for(var n=0;n<t.length;++n){t[n].filterAll()}};dc.renderAll=function(e){var t=dc.chartRegistry.list(e);for(var n=0;n<t.length;++n){t[n].render()}if(dc._renderlet!==null)dc._renderlet(e)};dc.redrawAll=function(e){var t=dc.chartRegistry.list(e);for(var n=0;n<t.length;++n){t[n].redraw()}if(dc._renderlet!==null)dc._renderlet(e)};dc.transition=function(e,t,n){if(t<=0||t===undefined)return e;var r=e.transition().duration(t);if(n instanceof Function){n(r)}return r};dc.units={};dc.units.integers=function(e,t){return Math.abs(t-e)};dc.units.ordinal=function(e,t,n){return n};dc.units.float={};dc.units.float.precision=function(e){var t=function(e,n,r){return Math.ceil(Math.abs((n-e)/t.resolution))};t.resolution=e;return t};dc.round={};dc.round.floor=function(e){return Math.floor(e)};dc.round.ceil=function(e){return Math.ceil(e)};dc.round.round=function(e){return Math.round(e)};dc.override=function(e,t,n){var r=e[t];e["_"+t]=r;e[t]=n};dc.renderlet=function(e){if(!arguments.length)return dc._renderlet;dc._renderlet=e;return dc};dc.instanceOfChart=function(e){return e instanceof Object&&e.__dc_flag__};dc.errors={};dc.errors.Exception=function(e){var t=e!=null?e:"Unexpected internal error";this.message=t;this.toString=function(){return t}};dc.errors.InvalidStateException=function(){dc.errors.Exception.apply(this,arguments)};dc.dateFormat=d3.time.format("%m/%d/%Y");dc.printers={};dc.printers.filter=function(e){var t="";if(e){if(e instanceof Array){if(e.length>=2)t="["+printSingleValue(e[0])+" -> "+printSingleValue(e[1])+"]";else if(e.length>=1)t=printSingleValue(e[0])}else{t=printSingleValue(e)}}return t};dc.utils={};dc.utils.add=function(e,t){if(typeof t==="string")t=t.replace("%","");if(e instanceof Date){if(typeof t==="string")t=+t;var n=new Date;n.setTime(e.getTime());n.setDate(e.getDate()+t);return n}else if(typeof t==="string"){var r=+t/100;return e>0?e*(1+r):e*(1-r)}else{return e+t}};dc.utils.subtract=function(e,t){if(typeof t==="string")t=t.replace("%","");if(e instanceof Date){if(typeof t==="string")t=+t;var n=new Date;n.setTime(e.getTime());n.setDate(e.getDate()-t);return n}else if(typeof t==="string"){var r=+t/100;return e<0?e*(1+r):e*(1-r)}else{return e-t}};dc.utils.GroupStack=function(){function r(t){if(!e[t])e[t]=[]}var e=[];var t=[];var n;this.setDataPoint=function(t,n,i){r(t);e[t][n]=i};this.getDataPoint=function(t,n){r(t);var i=e[t][n];if(i==undefined)i=0;return i};this.addGroup=function(e,r){if(!r)r=n;t.push([e,r]);return t.length-1};this.getGroupByIndex=function(e){return t[e][0]};this.getAccessorByIndex=function(e){return t[e][1]};this.size=function(){return t.length};this.clear=function(){e=[];t=[]};this.setDefaultAccessor=function(e){n=e};this.getDataPoints=function(){return e}};dc.utils.groupMax=function(e,t){var n=d3.max(e.all(),function(e){return t(e)});if(isNegligible(n))n=0;return n};dc.utils.groupMin=function(e,t){var n=d3.min(e.all(),function(e){return t(e)});if(isNegligible(n))n=0;return n};dc.utils.nameToId=function(e){return e.toLowerCase().replace(/[\s]/g,"_").replace(/[\.']/g,"")};dc.utils.appendOrSelect=function(e,t){var n=e.select(t);if(n.empty())n=e.append(t);return n};dc.events={current:null};dc.events.trigger=function(e,t){if(!t){e();return}dc.events.current=e;setTimeout(function(){if(e==dc.events.current)e()},t)};dc.cumulative={};dc.cumulative.Base=function(){this._keyIndex=[];this._map={};this.sanitizeKey=function(e){e=e+"";return e};this.clear=function(){this._keyIndex=[];this._map={}};this.size=function(){return this._keyIndex.length};this.getValueByKey=function(e){e=this.sanitizeKey(e);var t=this._map[e];return t};this.setValueByKey=function(e,t){e=this.sanitizeKey(e);return this._map[e]=t};this.indexOfKey=function(e){e=this.sanitizeKey(e);return this._keyIndex.indexOf(e)};this.addToIndex=function(e){e=this.sanitizeKey(e);this._keyIndex.push(e)};this.getKeyByIndex=function(e){return this._keyIndex[e]}};dc.cumulative.Sum=function(){dc.cumulative.Base.apply(this,arguments);this.add=function(e,t){if(t==null)t=0;if(this.getValueByKey(e)==null){this.addToIndex(e);this.setValueByKey(e,t)}else{this.setValueByKey(e,this.getValueByKey(e)+t)}};this.minus=function(e,t){this.setValueByKey(e,this.getValueByKey(e)-t)};this.cumulativeSum=function(e){var t=this.indexOfKey(e);if(t<0)return 0;var n=0;for(var r=0;r<=t;++r){var i=this.getKeyByIndex(r);n+=this.getValueByKey(i)}return n}};dc.cumulative.Sum.prototype=new dc.cumulative.Base;dc.cumulative.CountUnique=function(){function e(e){var t=0,n;for(n in e){if(e.hasOwnProperty(n))t++}return t}dc.cumulative.Base.apply(this,arguments);this.add=function(e,t){if(this.getValueByKey(e)==null){this.setValueByKey(e,{});this.addToIndex(e)}if(t!=null){if(this.getValueByKey(e)[t]==null)this.getValueByKey(e)[t]=0;this.getValueByKey(e)[t]+=1}};this.minus=function(e,t){this.getValueByKey(e)[t]-=1;if(this.getValueByKey(e)[t]<=0)delete this.getValueByKey(e)[t]};this.count=function(t){return e(this.getValueByKey(t))};this.cumulativeCount=function(e){var t=this.indexOfKey(e);if(t<0)return 0;var n=0;for(var r=0;r<=t;++r){var i=this.getKeyByIndex(r);n+=this.count(i)}return n}};dc.cumulative.CountUnique.prototype=new dc.cumulative.Base;dc.baseChart=function(e){e.__dc_flag__=true;var t;var n;var r;var i;var s;var o=200,u=200;var a=function(e){return e.key};var f=function(e){return e.value};var l=function(e){return e.key};var c=false;var h=function(e){return e.key+": "+e.value};var p=false;var d=750;var v=dc.printers.filter;var m=[];var g=dc.constants.DEFAULT_CHART_GROUP;var y=function(e){};var b={preRender:y,postRender:y,preRedraw:y,postRedraw:y,filtered:y};e.width=function(t){if(!arguments.length)return o;o=t;return e};e.height=function(t){if(!arguments.length)return u;u=t;return e};e.dimension=function(n){if(!arguments.length)return t;t=n;e.expireCache();return e};e.group=function(t){if(!arguments.length)return n;n=t;e.expireCache();return e};e.orderedGroup=function(){return n.order(function(e){return e.key})};e.filterAll=function(){return e.filter(null)};e.dataSet=function(){return t!=undefined&&n!=undefined};e.select=function(e){return i.select(e)};e.selectAll=function(e){return i.selectAll(e)};e.anchor=function(t,n){if(!arguments.length)return r;if(dc.instanceOfChart(t)){r=t.anchor();i=t.root()}else{r=t;i=d3.select(r);i.classed(dc.constants.CHART_CLASS,true);dc.registerChart(e,n)}g=n;return e};e.root=function(t){if(!arguments.length)return i;i=t;return e};e.svg=function(t){if(!arguments.length)return s;s=t;return e};e.resetSvg=function(){e.select("svg").remove();return e.generateSvg()};e.generateSvg=function(){s=e.root().append("svg").attr("width",e.width()).attr("height",e.height());return s};e.filterPrinter=function(t){if(!arguments.length)return v;v=t;return e};e.turnOnControls=function(){e.selectAll(".reset").style("display",null);e.selectAll(".filter").text(v(e.filter())).style("display",null);return e};e.turnOffControls=function(){e.selectAll(".reset").style("display","none");e.selectAll(".filter").style("display","none").text(e.filter());return e};e.transitionDuration=function(t){if(!arguments.length)return d;d=t;return e};e.render=function(){b.preRender(e);if(t==null)throw new dc.errors.InvalidStateException("Mandatory attribute chart.dimension is missing on chart["+e.anchor()+"]");if(n==null)throw new dc.errors.InvalidStateException("Mandatory attribute chart.group is missing on chart["+e.anchor()+"]");var r=e.doRender();if(e.transitionDuration()>0){setTimeout(function(){e.invokeRenderlet(e);b.postRender(e)},e.transitionDuration())}else{e.invokeRenderlet(e);b.postRender(e)}return r};e.redraw=function(){b.preRedraw(e);var t=e.doRedraw();e.invokeRenderlet(e);b.postRedraw(e);return t};e.invokeFilteredListener=function(t,n){if(n!==undefined)b.filtered(e,n)};e.filter=function(t){e.invokeFilteredListener(e,t);return e};e.doRender=function(){return e};e.doRedraw=function(){return e};e.keyAccessor=function(t){if(!arguments.length)return a;a=t;return e};e.valueAccessor=function(t){if(!arguments.length)return f;f=t;return e};e.label=function(t){if(!arguments.length)return l;l=t;c=true;return e};e.renderLabel=function(t){if(!arguments.length)return c;c=t;return e};e.title=function(t){if(!arguments.length)return h;h=t;p=true;return e};e.renderTitle=function(t){if(!arguments.length)return p;p=t;return e};e.renderlet=function(t){m.push(t);return e};e.invokeRenderlet=function(e){for(var t=0;t<m.length;++t){m[t](e)}};e.chartGroup=function(t){if(!arguments.length)return g;g=t;return e};e.on=function(t,n){b[t]=n;return e};e.expireCache=function(){return e};return e};dc.marginable=function(e){var t={top:10,right:50,bottom:30,left:30};e.margins=function(n){if(!arguments.length)return t;t=n;return e};e.effectiveWidth=function(){return e.width()-e.margins().left-e.margins().right};e.effectiveHeight=function(){return e.height()-e.margins().top-e.margins().bottom};return e};dc.coordinateGridChart=function(e){function C(t){if(e.elasticX()&&!e.isOrdinal()){a.domain([e.xAxisMin(),e.xAxisMax()])}if(e.isOrdinal()){e.prepareOrdinalXAxis()}else{a.range([0,e.xAxisLength()])}l=l.scale(e.x()).orient("bottom");k(t)}function k(t){if(x){var r=t.selectAll("g."+i);if(r.empty())r=t.insert("g",":first-child").attr("class",n+" "+i).attr("transform","translate("+e.yAxisX()+","+e.margins().top+")");var s=l.tickValues()?l.tickValues():a.ticks(l.ticks()[0]);var o=r.selectAll("line").data(s);var u=o.enter().append("line").attr("x1",function(e){return a(e)}).attr("y1",e.xAxisY()-e.margins().top).attr("x2",function(e){return a(e)}).attr("y2",0).attr("opacity",0);dc.transition(u,e.transitionDuration()).attr("opacity",1);dc.transition(o,e.transitionDuration()).attr("x1",function(e){return a(e)}).attr("y1",e.xAxisY()-e.margins().top).attr("x2",function(e){return a(e)}).attr("y2",0);o.exit().remove()}}function L(n){if(d==null||e.elasticY()){d=d3.scale.linear();d.domain([e.yAxisMin(),e.yAxisMax()]).rangeRound([e.yAxisHeight(),0])}d.range([e.yAxisHeight(),0]);v=v.scale(d).orient("left").ticks(t);A(n)}function A(t){if(S){var i=t.selectAll("g."+r);var s=v.tickValues()?v.tickValues():d.ticks(v.ticks()[0]);if(i.empty())i=t.insert("g",":first-child").attr("class",n+" "+r).attr("transform","translate("+e.yAxisX()+","+e.margins().top+")");var o=i.selectAll("line").data(s);var u=o.enter().append("line").attr("x1",1).attr("y1",function(e){return d(e)}).attr("x2",e.xAxisLength()).attr("y2",function(e){return d(e)}).attr("opacity",0);dc.transition(u,e.transitionDuration()).attr("opacity",1);dc.transition(o,e.transitionDuration()).attr("x1",1).attr("y1",function(e){return d(e)}).attr("x2",e.xAxisLength()).attr("y2",function(e){return d(e)});o.exit().remove()}}function O(){return e.xAxisY()-e.margins().top}function M(e){}function _(t){var n=e.extendBrush();e.redrawBrush(o);if(e.brushIsEmpty(n)){dc.events.trigger(function(){e.filter(null);dc.redrawAll(e.chartGroup())})}else{dc.events.trigger(function(){e.filter([n[0],n[1]]);dc.redrawAll(e.chartGroup())},dc.constants.EVENT_DELAY)}}function D(e){}function P(){return e.anchor().replace("#","")+"-clip"}function H(){var t=dc.utils.appendOrSelect(s,"defs");var n=dc.utils.appendOrSelect(t,"clipPath").attr("id",P());dc.utils.appendOrSelect(n,"rect").attr("x",e.margins().left).attr("y",e.margins().top).attr("width",e.xAxisLength()).attr("height",e.yAxisHeight())}function B(e){return e!=null&&e!=undefined&&e instanceof Array&&e.length>1}var t=5;var n="grid-line";var r="horizontal";var i="vertical";e=dc.marginable(dc.baseChart(e));var s;var o;var u;var a;var f;var l=d3.svg.axis();var c=dc.units.integers;var h=0;var p=false;var d;var v=d3.svg.axis();var m=0;var g=false;var y;var b=d3.svg.brush();var w=true;var E;var S=false;var x=false;var T=false;var N;e.generateG=function(t){if(t==null)s=e.svg();else s=t;o=s.append("g");u=o.append("g").attr("class","chartBody").attr("clip-path","url(#"+P()+")");return o};e.g=function(t){if(!arguments.length)return o;o=t;return e};e.chartBodyG=function(t){if(!arguments.length)return u;u=t;return e};e.x=function(t){if(!arguments.length)return a;a=t;f=a.domain();return e};e.xOriginalDomain=function(){return f};e.xUnits=function(t){if(!arguments.length)return c;c=t;return e};e.xAxis=function(t){if(!arguments.length)return l;l=t;return e};e.elasticX=function(t){if(!arguments.length)return p;p=t;return e};e.xAxisPadding=function(t){if(!arguments.length)return h;h=t;return e};e.xUnitCount=function(){if(N==null||e.refocused()){var t=e.xUnits()(e.x().domain()[0],e.x().domain()[1],e.x().domain());if(t instanceof Array)N=t.length;else N=t}return N};e.isOrdinal=function(){return e.xUnits()===dc.units.ordinal};e.prepareOrdinalXAxis=function(t){if(!t)t=e.xUnitCount();var n=[];var r=0;var i=e.xAxisLength()/t;for(var s=0;s<t;s++){n[s]=r;r+=i}a.range(n)};e.renderXAxis=function(t){var n=t.selectAll("g.x");if(n.empty())n=t.append("g").attr("class","axis x").attr("transform","translate("+e.margins().left+","+e.xAxisY()+")");dc.transition(n,e.transitionDuration()).call(l)};e.xAxisY=function(){return e.height()-e.margins().bottom};e.xAxisLength=function(){return e.effectiveWidth()};e.renderYAxis=function(t){var n=t.selectAll("g.y");if(n.empty())n=t.append("g").attr("class","axis y").attr("transform","translate("+e.yAxisX()+","+e.margins().top+")");dc.transition(n,e.transitionDuration()).call(v)};e.yAxisX=function(){return e.margins().left};e.y=function(t){if(!arguments.length)return d;d=t;return e};e.yAxis=function(t){if(!arguments.length)return v;v=t;return e};e.elasticY=function(t){if(!arguments.length)return g;g=t;return e};e.renderHorizontalGridLines=function(t){if(!arguments.length)return S;S=t;return e};e.renderVerticalGridLines=function(t){if(!arguments.length)return x;x=t;return e};e.xAxisMin=function(){var t=d3.min(e.group().all(),function(t){return e.keyAccessor()(t)});return dc.utils.subtract(t,h)};e.xAxisMax=function(){var t=d3.max(e.group().all(),function(t){return e.keyAccessor()(t)});return dc.utils.add(t,h)};e.yAxisMin=function(){var t=d3.min(e.group().all(),function(t){return e.valueAccessor()(t)});t=dc.utils.subtract(t,m);return t};e.yAxisMax=function(){var t=d3.max(e.group().all(),function(t){return e.valueAccessor()(t)});t=dc.utils.add(t,m);return t};e.yAxisPadding=function(t){if(!arguments.length)return m;m=t;return e};e.yAxisHeight=function(){return e.effectiveHeight()};e.round=function(t){if(!arguments.length)return E;E=t;return e};e.filter=function(t){if(!arguments.length)return y;if(t){y=t;e.brush().extent(t);e.dimension().filter(t);e.turnOnControls()}else{y=null;e.brush().clear();e.dimension().filterAll();e.turnOffControls()}e.invokeFilteredListener(e,t);return e};e.brush=function(t){if(!arguments.length)return b;b=t;return e};e.renderBrush=function(t){if(e.isOrdinal())w=false;if(w){b.on("brushstart",M).on("brush",_).on("brushend",D);var n=t.append("g").attr("class","brush").attr("transform","translate("+e.margins().left+","+e.margins().top+")").call(b.x(e.x()));n.selectAll("rect").attr("height",O());n.selectAll(".resize").append("path").attr("d",e.resizeHandlePath);if(y){e.redrawBrush(t)}}};e.extendBrush=function(){var t=b.extent();if(e.round()){t[0]=t.map(e.round())[0];t[1]=t.map(e.round())[1];o.select(".brush").call(b.extent(t))}return t};e.brushIsEmpty=function(e){return b.empty()||!e||e[1]<=e[0]};e.redrawBrush=function(t){if(w){if(e.filter()&&e.brush().empty())e.brush().extent(e.filter());var n=t.select("g.brush");n.call(e.brush().x(e.x()));n.selectAll("rect").attr("height",O())}e.fadeDeselectedArea()};e.fadeDeselectedArea=function(){};e.resizeHandlePath=function(e){var t=+(e=="e"),n=t?1:-1,r=O()/3;return"M"+.5*n+","+r+"A6,6 0 0 "+t+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+t+" "+.5*n+","+2*r+"Z"+"M"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)};e.doRender=function(){if(a==null)throw new dc.errors.InvalidStateException("Mandatory attribute chart.x is missing on chart["+e.anchor()+"]");e.resetSvg();if(e.dataSet()){e.generateG();H();C(e.g());L(e.g());e.plotData();e.renderXAxis(e.g());e.renderYAxis(e.g());e.renderBrush(e.g())}return e};e.doRedraw=function(){C(e.g());L(e.g());e.plotData();if(e.elasticY())e.renderYAxis(e.g());if(e.elasticX()||T)e.renderXAxis(e.g());e.redrawBrush(e.g());return e};e.subRender=function(){if(e.dataSet()){e.plotData()}return e};e.brushOn=function(t){if(!arguments.length)return w;w=t;return e};e.getDataWithinXDomain=function(t){var n=[];if(e.isOrdinal()){n=t.all()}else{t.all().forEach(function(t){var r=e.keyAccessor()(t);if(r>=e.x().domain()[0]&&r<=e.x().domain()[1])n.push(t)})}return n};e.focus=function(t){T=true;if(B(t)){e.x().domain(t)}else{e.x().domain(e.xOriginalDomain())}e.redraw();if(!B(t))T=false};e.refocused=function(){return T};return e};dc.colorChart=function(e){var t=d3.scale.category20c();var n=[0,t.range().length];var r=function(r){var i=n[0];var s=n[1];if(isNaN(r))r=0;if(s==null)return t(r);var o=e.colors().range().length;var u=(s-i)/o;var a=Math.abs(Math.min(o-1,Math.round((r-i)/u)));return e.colors()(a)};var i=function(e,t){return t};e.colors=function(r){if(!arguments.length)return t;if(r instanceof Array){t=d3.scale.ordinal().range(r);var i=[];for(var s=0;s<r.length;++s){i.push(s)}t.domain(i)}else{t=r}n=[0,t.range().length];return e};e.colorCalculator=function(t){if(!arguments.length)return r;r=t;return e};e.getColor=function(e,t){return r(i(e,t))};e.colorAccessor=function(t){if(!arguments.length)return i;i=t;return e};e.colorDomain=function(t){if(!arguments.length)return n;n=t;return e};return e};dc.singleSelectionChart=function(e){var t;var n=function(e,t){e.filter(t);return t};e.hasFilter=function(){return t!=null};e.filter=function(r){if(!arguments.length)return t;t=r;if(e.dataSet()&&e.dimension().filter!=undefined){var i=n(e.dimension(),t);t=i?i:t}if(r){e.turnOnControls()}else{e.turnOffControls()}e.invokeFilteredListener(e,r);return e};e.highlightSelected=function(e){d3.select(e).classed(dc.constants.SELECTED_CLASS,true);d3.select(e).classed(dc.constants.DESELECTED_CLASS,false)};e.fadeDeselected=function(e){d3.select(e).classed(dc.constants.SELECTED_CLASS,false);d3.select(e).classed(dc.constants.DESELECTED_CLASS,true)};e.resetHighlight=function(e){d3.select(e).classed(dc.constants.SELECTED_CLASS,false);d3.select(e).classed(dc.constants.DESELECTED_CLASS,false)};e.onClick=function(t){var n=e.keyAccessor()(t);dc.events.trigger(function(){e.filterTo(n==e.filter()?null:n)})};e.filterTo=function(t){e.filter(t);dc.redrawAll(e.chartGroup())};e.filterHandler=function(t){if(!arguments.length)return n;n=t;return e};return e};dc.stackableChart=function(e){function o(t,n){return e.getValueAccessorByIndex(t)(n)}function u(t,r){for(var i=0;i<t.length;++i){var s=t[i];var u=o(r,s);if(r==0){if(u>0)n.setDataPoint(r,i,e.dataPointBaseline()-e.dataPointHeight(s,r));else n.setDataPoint(r,i,e.dataPointBaseline())}else{if(u>0)n.setDataPoint(r,i,n.getDataPoint(r-1,i)-e.dataPointHeight(s,r));else if(u<0)n.setDataPoint(r,i,n.getDataPoint(r-1,i)+e.dataPointHeight(s,r-1));else n.setDataPoint(r,i,n.getDataPoint(r-1,i))}}}var t=0;var n=new dc.utils.GroupStack;var r;var i;var s;e.stack=function(t,r){n.setDefaultAccessor(e.valueAccessor());n.addGroup(t,r);e.expireCache();return e};e.expireCache=function(){r=null;i=null;s=null;return e};e.allGroups=function(){if(r==null){r=[];r.push(e.group());for(var t=0;t<n.size();++t)r.push(n.getGroupByIndex(t))}return r};e.allValueAccessors=function(){if(i==null){i=[];i.push(e.valueAccessor());for(var t=0;t<n.size();++t)i.push(n.getAccessorByIndex(t))}return i};e.getValueAccessorByIndex=function(t){return e.allValueAccessors()[t]};e.yAxisMin=function(){var t=0;var n=e.allGroups();for(var r=0;r<n.length;++r){var i=n[r];var s=dc.utils.groupMin(i,e.getValueAccessorByIndex(r));if(s<t)t=s}if(t<0){t=0;for(var r=0;r<n.length;++r){var i=n[r];t+=dc.utils.groupMin(i,e.getValueAccessorByIndex(r))}}t=dc.utils.subtract(t,e.yAxisPadding());return t};e.yAxisMax=function(){var t=0;var n=e.allGroups();for(var r=0;r<n.length;++r){var i=n[r];t+=dc.utils.groupMax(i,e.getValueAccessorByIndex(r))}t=dc.utils.add(t,e.yAxisPadding());return t};e.allKeyAccessors=function(){if(s==null){s=[];s.push(e.keyAccessor());for(var t=0;t<n.size();++t)s.push(e.keyAccessor())}return s};e.getKeyAccessorByIndex=function(t){return e.allKeyAccessors()[t]};e.xAxisMin=function(){var t=null;var n=e.allGroups();for(var r=0;r<n.length;++r){var i=n[r];var s=dc.utils.groupMin(i,e.getKeyAccessorByIndex(r));if(t==null||t>s)t=s}return dc.utils.subtract(t,e.xAxisPadding())};e.xAxisMax=function(){var t=null;var n=e.allGroups();for(var r=0;r<n.length;++r){var i=n[r];var s=dc.utils.groupMax(i,e.getKeyAccessorByIndex(r));if(t==null||t<s)t=s}return dc.utils.add(t,e.xAxisPadding())};e.baseLineY=function(){return e.y()(0)};e.dataPointBaseline=function(){return e.margins().top+e.baseLineY()};e.dataPointHeight=function(n,r){var i=o(r,n);var s=e.y()(i);var u=e.baseLineY();var a=0;if(i>0)a=u-s;else a=s-u;if(isNaN(a)||a<t)a=t;return a};e.calculateDataPointMatrixForAll=function(e){for(var t=0;t<e.length;++t){var n=e[t];var r=n.all();u(r,t)}};e.calculateDataPointMatrixWithinXDomain=function(t){for(var n=0;n<t.length;++n){var r=t[n];var i=e.getDataWithinXDomain(r);u(i,n)}};e.getChartStack=function(){return n};dc.override(e,"valueAccessor",function(t){if(!arguments.length)return e._valueAccessor();e.expireCache();return e._valueAccessor(t)});dc.override(e,"keyAccessor",function(t){if(!arguments.length)return e._keyAccessor();e.expireCache();return e._keyAccessor(t)});return e};dc.abstractBubbleChart=function(e){var t=.3;var n=10;e.BUBBLE_NODE_CLASS="node";e.BUBBLE_CLASS="bubble";e.MIN_RADIUS=10;e=dc.singleSelectionChart(dc.colorChart(e));e.renderLabel(true);e.renderTitle(false);var r=d3.scale.linear().domain([0,100]);var i=function(e){return e.r};e.r=function(t){if(!arguments.length)return r;r=t;return e};e.radiusValueAccessor=function(t){if(!arguments.length)return i;i=t;return e};e.rMin=function(){var t=d3.min(e.group().all(),function(t){return e.radiusValueAccessor()(t)});return t};e.rMax=function(){var t=d3.max(e.group().all(),function(t){return e.radiusValueAccessor()(t)});return t};e.bubbleR=function(t){var n=e.radiusValueAccessor()(t);var r=e.r()(n);if(isNaN(r)||n<=0)r=0;return r};var s=function(t){return e.label()(t)};var o=function(t){return e.bubbleR(t)>n?1:0};e.doRenderLabel=function(t){if(e.renderLabel()){var n=t.select("text");if(n.empty()){n=t.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",e.onClick)}n.attr("opacity",0).text(s);dc.transition(n,e.transitionDuration()).attr("opacity",o)}};e.doUpdateLabels=function(t){if(e.renderLabel()){var n=t.selectAll("text").text(s);dc.transition(n,e.transitionDuration()).attr("opacity",o)}};var u=function(t){return e.title()(t)};e.doRenderTitles=function(t){if(e.renderTitle()){var n=t.select("title");if(n.empty())t.append("title").text(u)}};e.doUpdateTitles=function(t){if(e.renderTitle()){t.selectAll("title").text(u)}};e.minRadiusWithLabel=function(t){if(!arguments.length)return n;n=t;return e};e.maxBubbleRelativeSize=function(n){if(!arguments.length)return t;t=n;return e};e.initBubbleColor=function(t,n){this[dc.constants.NODE_INDEX_NAME]=n;return e.getColor(t,n)};e.updateBubbleColor=function(t,n){return e.getColor(t,this[dc.constants.NODE_INDEX_NAME])};e.fadeDeselectedArea=function(){if(e.hasFilter()){e.selectAll("g."+e.BUBBLE_NODE_CLASS).each(function(t){if(e.isSelectedNode(t)){e.highlightSelected(this)}else{e.fadeDeselected(this)}})}else{e.selectAll("g."+e.BUBBLE_NODE_CLASS).each(function(t){e.resetHighlight(this)})}};e.isSelectedNode=function(t){return e.filter()==t.key};e.onClick=function(t){var n=t.key;if(n==e.filter()){dc.events.trigger(function(){e.filter(null);dc.redrawAll(e.chartGroup())})}else{dc.events.trigger(function(){e.filter(n);dc.redrawAll(e.chartGroup())})}};return e};dc.pieChart=function(e,t){function f(){if(a.dataSet()){var e=E();var t=a.buildArcs();var n=e(a.orderedGroup().top(Infinity));var i=o.selectAll("g."+r).data(n);l(i,t,n);v(n,t);b(i);w()}}function l(e,t,n){var r=c(e);h(r,t);p(r);d(n,t)}function c(e){var t=e.enter().append("g").attr("class",function(e,t){return r+" _"+t});return t}function h(e,t){var n=e.append("path").attr("fill",function(e,t){return a.getColor(e,t)}).on("click",C).attr("d",function(e,n){return k(e,n,t)});n.transition().duration(a.transitionDuration()).attrTween("d",T)}function p(e){if(a.renderTitle()){e.append("title").text(function(e){return a.title()(e)})}}function d(e,t){if(a.renderLabel()){var n=o.selectAll("text."+r).data(e);var s=n.enter().append("text").attr("class",function(e,t){return r+" _"+t}).on("click",C);dc.transition(s,a.transitionDuration()).attr("transform",function(e){e.innerRadius=a.innerRadius();e.outerRadius=i;var n=t.centroid(e);if(isNaN(n[0])||isNaN(n[1])){return"translate(0,0)"}else{return"translate("+n+")"}}).attr("text-anchor","middle").text(function(e){var t=e.data;if(x(t)||S(e))return"";return a.label()(e)})}}function v(e,t){m(e,t);g(e,t);y(e)}function m(e,t){var n=o.selectAll("g."+r).data(e).select("path").attr("d",function(e,n){return k(e,n,t)});dc.transition(n,a.transitionDuration(),function(e){e.attrTween("d",T)}).attr("fill",function(e,t){return a.getColor(e,t)})}function g(e,t){if(a.renderLabel()){var n=o.selectAll("text."+r).data(e);dc.transition(n,a.transitionDuration()).attr("transform",function(e){e.innerRadius=a.innerRadius();e.outerRadius=i;var n=t.centroid(e);if(isNaN(n[0])||isNaN(n[1])){return"translate(0,0)"}else{return"translate("+n+")"}}).attr("text-anchor","middle").text(function(e){var t=e.data;if(x(t)||S(e))return"";return a.label()(e)})}}function y(e){if(a.renderTitle()){o.selectAll("g."+r).data(e).select("title").text(function(e){return a.title()(e)})}}function b(e){e.exit().remove()}function w(){if(a.hasFilter()){a.selectAll("g."+r).each(function(e){if(a.isSelectedSlice(e)){a.highlightSelected(this)}else{a.fadeDeselected(this)}})}else{a.selectAll("g."+r).each(function(e){a.resetHighlight(this)})}}function E(){return d3.layout.pie().sort(null).value(function(e){return a.valueAccessor()(e)})}function S(e){var t=e.endAngle-e.startAngle;return isNaN(t)||t<u}function x(e){return a.valueAccessor()(e)==0}function T(e){e.innerRadius=a.innerRadius();var t=this._current;if(N(t))t={startAngle:0,endAngle:0};var n=d3.interpolate(t,e);this._current=n(0);return function(e){return k(n(e),0,a.buildArcs())}}function N(e){return e==null||isNaN(e.startAngle)||isNaN(e.endAngle)}function C(e){a.onClick(e.data)}function k(e,t,n){var r=n(e,t);if(r.indexOf("NaN")>=0)r="M0,0";return r}var n=.5;var r="pie-slice";var i=90,s=0;var o;var u=n;var a=dc.singleSelectionChart(dc.colorChart(dc.baseChart({})));a.label(function(e){return a.keyAccessor()(e.data)});a.renderLabel(true);a.title(function(e){return a.keyAccessor()(e.data)+": "+a.valueAccessor()(e.data)});a.transitionDuration(350);a.doRender=function(){a.resetSvg();o=a.svg().append("g").attr("transform","translate("+a.cx()+","+a.cy()+")");f();return a};a.innerRadius=function(e){if(!arguments.length)return s;s=e;return a};a.radius=function(e){if(!arguments.length)return i;i=e;return a};a.cx=function(){return a.width()/2};a.cy=function(){return a.height()/2};a.buildArcs=function(){return d3.svg.arc().outerRadius(i).innerRadius(s)};a.isSelectedSlice=function(e){return a.filter()==a.keyAccessor()(e.data)};a.doRedraw=function(){f();return a};a.minAngleForLabel=function(e){if(!arguments.length)return u;u=e;return a};return a.anchor(e,t)};dc.barChart=function(e,t){function f(e,t){var n=i.chartBodyG().selectAll("rect."+dc.constants.STACK_CLASS+e).data(i.getDataWithinXDomain(t));l(n,e);c(n,e);h(n)}function l(e,t){var e=e.enter().append("rect");e.attr("class","bar "+dc.constants.STACK_CLASS+t).attr("x",function(e,n){return m(this,e,t,n)}).attr("y",i.baseLineY()).attr("width",d);if(i.isOrdinal())e.on("click",i.onClick);if(i.renderTitle()){e.append("title").text(i.title())}dc.transition(e,i.transitionDuration()).attr("y",function(e,t){return y(this,e,t)}).attr("height",function(e){return i.dataPointHeight(e,g(this))})}function c(e,t){if(i.renderTitle()){e.select("title").text(i.title())}dc.transition(e,i.transitionDuration()).attr("x",function(e,n){return m(this,e,t,n)}).attr("y",function(e,t){return y(this,e,t)}).attr("height",function(e){return i.dataPointHeight(e,g(this))}).attr("width",d)}function h(e){dc.transition(e.exit(),i.transitionDuration()).attr("y",i.xAxisY()).attr("height",0)}function p(){if(u==null||i.refocused()){u=i.xUnitCount()}return u}function d(e){if(a==null||i.refocused()){var t=p();var r=n;if(i.isOrdinal())r=Math.floor(i.xAxisLength()/(t+1));else r=Math.floor(i.xAxisLength()/t);r-=s;if(isNaN(r)||r<n)r=n;a=r}return a}function v(e,t){e[dc.constants.GROUP_INDEX_NAME]=t}function m(e,t,n,r){v(e,n);var s=i.x()(i.keyAccessor()(t))+i.margins().left;if(o)s=s-d(t)/2;return s}function g(e){var t=e[dc.constants.GROUP_INDEX_NAME];return t}function y(e,t,n){var r=g(e);return i.getChartStack().getDataPoint(r,n)}var n=1;var r=2;var i=dc.stackableChart(dc.coordinateGridChart(dc.singleSelectionChart({})));var s=r;var o=false;var u;var a;i.plotData=function(){var e=i.allGroups();i.calculateDataPointMatrixWithinXDomain(e);for(var t=0;t<e.length;++t){f(t,e[t])}};i.fadeDeselectedArea=function(){var e=i.chartBodyG().selectAll("rect.bar");var t=i.brush().extent();if(i.isOrdinal()){if(i.filter()!=null)e.classed(dc.constants.DESELECTED_CLASS,function(e){var t=i.keyAccessor()(e);return t!=i.filter()});else e.classed(dc.constants.DESELECTED_CLASS,false)}else{if(!i.brushIsEmpty(t)){var n=t[0];var r=t[1];e.classed(dc.constants.DESELECTED_CLASS,function(e){var t=i.keyAccessor()(e);return t<n||t>=r})}else{e.classed(dc.constants.DESELECTED_CLASS,false)}}};i.centerBar=function(e){if(!arguments.length)return o;o=e;return i};i.gap=function(e){if(!arguments.length)return s;s=e;return i};i.extendBrush=function(){var e=i.brush().extent();if(i.round()&&!o){e[0]=e.map(i.round())[0];e[1]=e.map(i.round())[1];i.chartBodyG().select(".brush").call(i.brush().extent(e))}return e};dc.override(i,"prepareOrdinalXAxis",function(){return this._prepareOrdinalXAxis(i.xUnitCount()+1)});return i.anchor(e,t)};dc.lineChart=function(e,t){function c(e,t){var n=h(e);var r=p(n,t);var i=d(r,n,e);if(f)g(r,n,e,i);if(a.renderTitle())y(r,e)}function h(e){return dc.constants.STACK_CLASS+e}function p(e,t){var n=a.chartBodyG().select("g."+e);if(n.empty())n=a.chartBodyG().append("g").attr("class",e);n.datum(t.all());return n}function d(e,t,n){var r=e.select("path.line");if(r.empty())r=e.append("path").attr("class","line "+t);r[0][0][dc.constants.GROUP_INDEX_NAME]=n;var i=d3.svg.line().x(v).y(function(e,t){var n=this[dc.constants.GROUP_INDEX_NAME];return m(e,t,n)});dc.transition(r,a.transitionDuration(),function(e){e.ease("linear")}).attr("d",i);return i}function g(e,t,r,i){var s=e.select("path.area");if(s.empty())s=e.append("path").attr("class","area "+t);s[0][0][dc.constants.GROUP_INDEX_NAME]=r;var o=d3.svg.area().x(i.x()).y1(i.y()).y0(function(e,t){var r=this[dc.constants.GROUP_INDEX_NAME];if(r==0)return a.dataPointBaseline()-n;var i=a.getChartStack().getDataPoint(r-1,t);if(i<a.dataPointBaseline())return i-n;else return i+a.dataPointHeight(e,r-1)});dc.transition(s,a.transitionDuration(),function(e){e.ease("linear")}).attr("d",o)}function y(e,t){var n=e.select("g."+i);if(n.empty())n=e.append("g").attr("class",i);b(n);var r=n.selectAll("circle."+s).data(n.datum());r.enter().append("circle").attr("class",s).attr("r",l).style("fill-opacity",1e-6).style("stroke-opacity",1e-6).on("mousemove",function(e){var t=d3.select(this);w(t);E(t,n)}).on("mouseout",function(e){var t=d3.select(this);S(t);x(n)}).append("title").text(a.title());r.attr("cx",v).attr("cy",function(e,n){return m(e,n,t)}).select("title").text(a.title());r.exit().remove()}function b(e){var t=e.select("path."+o).empty()?e.append("path").attr("class",o):e.select("path."+o);t.style("display","none").attr("stroke-dasharray","5,5");var n=e.select("path."+u).empty()?e.append("path").attr("class",u):e.select("path."+u);n.style("display","none").attr("stroke-dasharray","5,5")}function w(e){e.style("fill-opacity",.8);e.style("stroke-opacity",.8);return e}function E(e,t){var n=e.attr("cx");var r=e.attr("cy");t.select("path."+o).style("display","").attr("d","M"+a.margins().left+" "+r+"L"+n+" "+r);t.select("path."+u).style("display","").attr("d","M"+n+" "+(a.height()-a.margins().bottom)+"L"+n+" "+r)}function S(e){e.style("fill-opacity",1e-6).style("stroke-opacity",1e-6)}function x(e){e.select("path."+o).style("display","none");e.select("path."+u).style("display","none")}var n=1;var r=5;var i="dc-tooltip";var s="dot";var o="yRef";var u="xRef";var a=dc.stackableChart(dc.coordinateGridChart({}));var f=false;var l=r;a.transitionDuration(500);a.plotData=function(){var e=a.allGroups();a.calculateDataPointMatrixForAll(e);for(var t=0;t<e.length;++t){var n=e[t];c(t,n)}};var v=function(e){return a.margins().left+a.x()(a.keyAccessor()(e))};var m=function(e,t,n){var r=a.getChartStack().getDataPoint(n,t);if(r>=a.dataPointBaseline())r+=a.dataPointHeight(e,n);return r};a.renderArea=function(e){if(!arguments.length)return f;f=e;return a};a.dotRadius=function(e){if(!arguments.length)return l;l=e;return a};return a.anchor(e,t)};dc.dataCount=function(e,t){var n=d3.format(",d");var r=dc.baseChart({});r.doRender=function(){r.selectAll(".total-count").text(n(r.dimension().size()));r.selectAll(".filter-count").text(n(r.group().value()));return r};r.doRedraw=function(){return r.doRender()};return r.anchor(e,t)};dc.dataTable=function(e,t){function h(){var e=o.root().selectAll("tbody").data(p(),function(e){return o.keyAccessor()(e)});var t=e.enter().append("tbody");t.append("tr").attr("class",s).append("td").attr("class",n).attr("colspan",a.length).html(function(e){return o.keyAccessor()(e)});e.exit().remove();return t}function p(){if(!c)c=crossfilter.quicksort.by(f);var e=o.dimension().top(u);return d3.nest().key(o.group()).sortKeys(l).entries(c(e,0,e.length))}function d(e){var t=e.order().selectAll("tr."+r).data(function(e){return e.values});var n=t.enter().append("tr").attr("class",r);for(var s=0;s<a.length;++s){var o=a[s];n.append("td").attr("class",i+" _"+s).html(function(e){return o(e)})}t.exit().remove();return t}var n="dc-table-label";var r="dc-table-row";var i="dc-table-column";var s="dc-table-group";var o=dc.baseChart({});var u=25;var a=[];var f=function(e){return e};var l=d3.ascending;var c;o.doRender=function(){o.selectAll("tbody").remove();d(h());return o};o.doRedraw=function(){return o.doRender()};o.size=function(e){if(!arguments.length)return u;u=e;return o};o.columns=function(e){if(!arguments.length)return a;a=e;return o};o.sortBy=function(e){if(!arguments.length)return f;f=e;return o};o.order=function(e){if(!arguments.length)return l;l=e;return o};return o.anchor(e,t)};dc.bubbleChart=function(e,t){function s(e){var t=e.enter().append("g");t.attr("class",n.BUBBLE_NODE_CLASS).attr("transform",i).append("circle").attr("class",function(e,t){return n.BUBBLE_CLASS+" _"+t}).on("click",n.onClick).attr("fill",n.initBubbleColor).attr("r",0);dc.transition(e,n.transitionDuration()).attr("r",function(e){return n.bubbleR(e)}).attr("opacity",function(e){return n.bubbleR(e)>0?1:0});n.doRenderLabel(t);n.doRenderTitles(t)}function o(e){dc.transition(e,n.transitionDuration()).attr("transform",i).selectAll("circle."+n.BUBBLE_CLASS).attr("fill",n.updateBubbleColor).attr("r",function(e){return n.bubbleR(e)}).attr("opacity",function(e){return n.bubbleR(e)>0?1:0});n.doUpdateLabels(e);n.doUpdateTitles(e)}function u(e){e.exit().remove()}function a(e){var t=n.x()(n.keyAccessor()(e))+n.margins().left;if(isNaN(t))t=0;return t}function f(e){var t=n.margins().top+n.y()(n.valueAccessor()(e));if(isNaN(t))t=0;return t}var n=dc.abstractBubbleChart(dc.coordinateGridChart({}));var r=false;n.transitionDuration(750);var i=function(e){return"translate("+a(e)+","+f(e)+")"};n.elasticRadius=function(e){if(!arguments.length)return r;r=e;return n};n.plotData=function(){if(r)n.r().domain([n.rMin(),n.rMax()]);n.r().range([n.MIN_RADIUS,n.xAxisLength()*n.maxBubbleRelativeSize()]);var e=n.chartBodyG().selectAll("g."+n.BUBBLE_NODE_CLASS).data(n.group().all());s(e);o(e);u(e);n.fadeDeselectedArea()};n.renderBrush=function(e){};n.redrawBrush=function(e){n.fadeDeselectedArea()};return n.anchor(e,t)};dc.compositeChart=function(e,t){function s(e,t){e.generateG(r.g());e.g().attr("class",n+" _"+t)}function o(){var e=[];for(var t=0;t<i.length;++t){e.push(i[t].yAxisMin())}return e}function u(){var e=[];for(var t=0;t<i.length;++t){e.push(i[t].yAxisMax())}return e}function a(){var e=[];for(var t=0;t<i.length;++t){e.push(i[t].xAxisMin())}return e}function f(){var e=[];for(var t=0;t<i.length;++t){e.push(i[t].xAxisMax())}return e}var n="sub";var r=dc.coordinateGridChart({});var i=[];r.transitionDuration(500);dc.override(r,"generateG",function(){var e=this._generateG();for(var t=0;t<i.length;++t){var n=i[t];s(n,t);if(n.dimension()==null)n.dimension(r.dimension());if(n.group()==null)n.group(r.group());n.chartGroup(r.chartGroup());n.svg(r.svg());n.height(r.height());n.width(r.width());n.margins(r.margins());n.xUnits(r.xUnits());n.transitionDuration(r.transitionDuration())}return e});r.plotData=function(){for(var e=0;e<i.length;++e){var t=i[e];if(t.g()==null){s(t,e)}t.x(r.x());t.y(r.y());t.xAxis(r.xAxis());t.yAxis(r.yAxis());t.plotData();t.invokeRenderlet(t)}};r.fadeDeselectedArea=function(){for(var e=0;e<i.length;++e){var t=i[e];t.brush(r.brush());t.fadeDeselectedArea()}};r.compose=function(e){i=e;return r};r.children=function(){return i};r.yAxisMin=function(){return d3.min(o())};r.yAxisMax=function(){return dc.utils.add(d3.max(u()),r.yAxisPadding())};r.xAxisMin=function(){return dc.utils.subtract(d3.min(a()),r.xAxisPadding())};r.xAxisMax=function(){return dc.utils.add(d3.max(f()),r.xAxisPadding())};return r.anchor(e,t)};dc.geoChoroplethChart=function(e,t){function s(e){var t=dc.utils.groupMax(n.group(),n.valueAccessor());var r=o();if(u(e)){var i=a(e);d(i,e,r,t);v(i,e,r)}}function o(){var e={};var t=n.group().all();for(var r=0;r<t.length;++r){e[n.keyAccessor()(t[r])]=n.valueAccessor()(t[r])}return e}function u(e){return p(e).keyAccessor}function a(e){var t=n.svg().selectAll(f(e)).classed("selected",function(t){return l(e,t)}).classed("deselected",function(t){return c(e,t)}).attr("class",function(t){var n=p(e).name;var r=dc.utils.nameToId(p(e).keyAccessor(t));var i=n+" "+r;if(l(e,t))i+=" selected";if(c(e,t))i+=" deselected";return i});return t}function f(e){return"g.layer"+e+" g."+p(e).name}function l(e,t){return n.hasFilter()&&n.filter()==h(e,t)}function c(e,t){return n.hasFilter()&&n.filter()!=h(e,t)}function h(e,t){return p(e).keyAccessor(t)}function p(e){return i[e]}function d(e,t,r,i){var s=e.select("path").attr("fill",function(e){var t=d3.select(this).attr("fill");if(t)return t;return"none"}).on("click",function(e){return n.onClick(e,t)});dc.transition(s,n.transitionDuration()).attr("fill",function(e,i){return n.getColor(r[p(t).keyAccessor(e)],i)})}function v(e,t,r){if(n.renderTitle()){e.selectAll("title").text(function(e){var i=h(t,e);var s=r[i];return n.title()({key:i,value:s})})}}var n=dc.singleSelectionChart(dc.colorChart(dc.baseChart({})));n.colorAccessor(function(e,t){return e});var r=d3.geo.path();var i=[];n.doRender=function(){n.resetSvg();for(var e=0;e<i.length;++e){var t=n.svg().append("g").attr("class","layer"+e);var o=t.selectAll("g."+p(e).name).data(p(e).data).enter().append("g").attr("class",p(e).name);o.append("path").attr("fill","white").attr("d",r);o.append("title");s(e)}};n.onClick=function(e,t){var r=p(t).keyAccessor(e);if(r==n.filter()){dc.events.trigger(function(){n.filter(null);dc.redrawAll(n.chartGroup())})}else{dc.events.trigger(function(){n.filter(r);dc.redrawAll(n.chartGroup())})}};n.doRedraw=function(){for(var e=0;e<i.length;++e){s(e)}};n.overlayGeoJson=function(e,t,r){for(var s=0;s<i.length;++s){if(i[s].name==t){i[s].data=e;i[s].keyAccessor=r;return n}}i.push({name:t,data:e,keyAccessor:r});return n};n.projection=function(e){r.projection(e);return n};n.geoJsons=function(){return i};n.removeGeoJson=function(e){var t=[];for(var r=0;r<i.length;++r){var s=i[r];if(s.name!=e){t.push(s)}}i=t;return n};return n.anchor(e,t)};dc.bubbleOverlay=function(e,t){function a(){o=s.select("g."+n);if(o.empty())o=s.svg().append("g").attr("class",n);return o}function f(){var e=l();u.forEach(function(t){var n=c(t,e);var r=n.select("circle."+i);if(r.empty())r=n.append("circle").attr("class",i).attr("r",0).attr("fill",s.initBubbleColor).on("click",s.onClick);dc.transition(r,s.transitionDuration()).attr("r",function(e){return s.bubbleR(e)});s.doRenderLabel(n);s.doRenderTitles(n)})}function l(){var e={};s.group().all().forEach(function(t){e[s.keyAccessor()(t)]=t});return e}function c(e,t){var n=r+" "+dc.utils.nameToId(e.name);var i=o.select("g."+dc.utils.nameToId(e.name));if(i.empty()){i=o.append("g").attr("class",n).attr("transform","translate("+e.x+","+e.y+")")}i.datum(t[e.name]);return i}function h(){var e=l();u.forEach(function(t){var n=c(t,e);var r=n.select("circle."+i);dc.transition(r,s.transitionDuration()).attr("r",function(e){return s.bubbleR(e)}).attr("fill",s.updateBubbleColor);s.doUpdateLabels(n);s.doUpdateTitles(n)})}var n="bubble-overlay";var r="node";var i="bubble";var s=dc.abstractBubbleChart(dc.baseChart({}));var o;var u=[];s.transitionDuration(750);s.radiusValueAccessor(function(e){return e.value});s.point=function(e,t,n){u.push({name:e,x:t,y:n});return s};s.doRender=function(){o=a();s.r().range([s.MIN_RADIUS,s.width()*s.maxBubbleRelativeSize()]);f();s.fadeDeselectedArea();return s};s.doRedraw=function(){h();s.fadeDeselectedArea();return s};s.debug=function(e){if(e){var t=s.select("g."+dc.constants.DEBUG_GROUP_CLASS);if(t.empty())t=s.svg().append("g").attr("class",dc.constants.DEBUG_GROUP_CLASS);var n=t.append("text").attr("x",10).attr("y",20);t.append("rect").attr("width",s.width()).attr("height",s.height()).on("mousemove",function(){var e=d3.mouse(t.node());var r=e[0]+", "+e[1];n.text(r)})}else{s.selectAll(".debug").remove()}return s};s.anchor(e,t);return s};dc.rowChart=function(e,t){function l(){var e=f.tickValues()?f.tickValues():a.ticks(f.ticks()[0]);var t=n.append("g").attr("class","grid-line vertical");var r=t.selectAll("line").data(e);var i=r.enter().append("line").attr("x1",function(e){return a(e)}).attr("y1",function(e){return 0}).attr("x2",function(e){return a(e)}).attr("y2",function(e){return u.effectiveHeight()})}function c(){var e=n.selectAll("g."+o).data(u.group().all());h(e,u.group().all());p(e);d(e)}function h(e,t){var n=e.enter().append("g").attr("class",function(e,t){return o+" _"+t});n.append("rect").attr("width",0);v(n);m(n);g(e)}function p(e){e.exit().remove()}function d(e){var t=u.group().all().length;var n=(u.effectiveHeight()-(t+1)*s)/t;var r=e.attr("transform",function(e,t){return"translate(0,"+((t+1)*s+t*n)+")"}).select("rect").attr("height",n).attr("fill",u.getColor).on("click",w).classed("deselected",function(e){return u.hasFilter()?!u.isSelectedRow(e):false}).classed("selected",function(e){return u.hasFilter()?u.isSelectedRow(e):false});dc.transition(r,u.transitionDuration()).attr("width",function(e){return a(u.valueAccessor()(e))})}function v(e){if(u.renderTitle()){e.append("title").text(function(e){return u.title()(e)})}}function m(e){if(u.renderLabel()){e.append("text")}}function g(e){if(u.renderLabel()){e.select("text").attr("x",r).attr("y",i).attr("class",function(e,t){return o+" _"+t}).text(function(e){return u.label()(e)})}}function y(){return u.group().all().length}function b(){var e=y();return(u.effectiveHeight()-(e+1)*s)/e}function w(e){u.onClick(e)}var n;var r=10;var i=15;var s=5;var o="row";var u=dc.marginable(dc.singleSelectionChart(dc.colorChart(dc.baseChart({}))));var a;var f=d3.svg.axis().orient("bottom");u.doRender=function(){a=d3.scale.linear().domain([0,d3.max(u.group().all(),u.valueAccessor())]).range([0,u.effectiveWidth()]);u.resetSvg();n=u.svg().append("g").attr("transform","translate("+u.margins().left+","+u.margins().top+")");f.scale(a);n.append("g").attr("class","axis").attr("transform","translate(0, "+u.effectiveHeight()+")").call(f);l();c();return u};u.title(function(e){return u.keyAccessor()(e)+": "+u.valueAccessor()(e)});u.label(function(e){return u.keyAccessor()(e)});u.doRedraw=function(){c();return u};u.xAxis=function(){return f};u.gap=function(e){if(!arguments.length)return s;s=e;return u};u.labelOffsetX=function(e){if(!arguments.length)return r;_labelOffset=e;return u};u.labelOffsetY=function(e){if(!aruguments.length)return i;_labelOffset=e;return u};u.isSelectedRow=function(e){return u.filter()==u.keyAccessor()(e)};return u.anchor(e,t)}